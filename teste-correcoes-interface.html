<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Teste das Corre√ß√µes - Auditoria SoundyAI</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0d1421;
            color: #f5f7fa;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .card {
            background: #1a2332;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: #9fc9ff;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .data-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .data-row:last-child {
            border-bottom: none;
        }
        .label {
            color: #b8c2d6;
            font-weight: 500;
        }
        .value {
            color: #f5f7fa;
            font-weight: 600;
        }
        .ref-compare-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        .ref-compare-table th {
            background: #132132;
            color: #c9e4ff;
            font-weight: 500;
            padding: 8px 12px;
            text-align: left;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .ref-compare-table td {
            padding: 8px 12px;
            border: 1px solid rgba(255,255,255,0.05);
        }
        .ref-compare-table tr:hover {
            background: rgba(255,255,255,0.03);
        }
        .btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        .btn:hover {
            background: #218838;
        }
        .btn-secondary {
            background: #17a2b8;
        }
        .btn-secondary:hover {
            background: #138496;
        }
        .status {
            padding: 8px 16px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: 600;
        }
        .status.success {
            background: rgba(40, 167, 69, 0.2);
            color: #52f7ad;
            border: 1px solid rgba(40, 167, 69, 0.3);
        }
        .status.warning {
            background: rgba(255, 193, 7, 0.2);
            color: #ffce4d;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }
        .code {
            background: #0f1826;
            border: 1px solid rgba(255,255,255,0.1);
            padding: 16px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Teste das Corre√ß√µes - Auditoria Explorat√≥ria SoundyAI</h1>
        
        <div class="card">
            <div class="card-title">üéØ Status das Corre√ß√µes</div>
            <div id="correctionStatus">
                <div class="status warning">‚è≥ Carregando extens√µes...</div>
            </div>
            
            <button class="btn" onclick="loadCorrections()">üîß Carregar Corre√ß√µes</button>
            <button class="btn btn-secondary" onclick="testCorrections()">üß™ Testar Corre√ß√µes</button>
            <button class="btn btn-secondary" onclick="simulateAnalysis()">üéµ Simular An√°lise</button>
        </div>

        <div id="testResults" class="grid" style="display: none;">
            <!-- Cards de teste ser√£o inseridos aqui -->
        </div>

        <div id="modalTechnicalData" style="display: none;">
            <!-- Container para simular onde as corre√ß√µes ser√£o injetadas -->
        </div>

        <div id="referenceComparisons">
            <!-- Container para compara√ß√µes de refer√™ncia -->
        </div>
    </div>

    <!-- Simular dados reais da auditoria -->
    <script>
        // Dados REAIS do job auditado: 7bfa433e-344b-4baa-a327-c88825c78239
        const simulatedAnalysisData = {
            mode: 'pipeline_complete_mathematical',
            status: 'success',
            overallScore: 7.5,
            classification: 'Profissional',
            
            technicalData: {
                bitrate: 1411,
                peak_db: -0.1,
                channels: 2,
                rms_level: -12.5,
                true_peak: -0.97,
                balance_lr: 0.02,
                headroomDb: 0.1,
                sampleRate: 48000,
                durationSec: 897.6,
                crest_factor: 12.4,
                stereo_width: 0.6,
                truePeakDbtp: -0.97,
                dynamic_range: 6.2,
                spectral_flux: 0.234,
                lufs_momentary: -17.0,
                lufs_integrated: -17.3,
                lufs_short_term: -17.0,
                spectral_rolloff: 8467.3,
                spectral_centroid: 1487.5,
                spectral_flatness: 0.123,
                stereo_correlation: 0.74,
                zero_crossing_rate: 0.078,
                fftOperations: 10509,
                samplesProcessed: 43115140,
                
                // üéØ BANDAS ESPECTRAIS COMPLETAS (6 bandas)
                spectral_balance: {
                    sub: 0.12,      // 20-60 Hz
                    bass: 0.34,     // 60-250 Hz  
                    mids: 0.41,     // 250-4k Hz
                    treble: 0.08,   // 4k-12k Hz
                    presence: 0.05, // 4k-8k Hz
                    air: 0.02       // 12k-20k Hz
                },
                
                // üéØ FREQU√äNCIAS DOMINANTES COMPLETAS (15 frequ√™ncias)
                dominantFrequencies: [
                    { frequency: 17767, amplitude: -18.044, occurrences: 238 },
                    { frequency: 8834, amplitude: -21.231, occurrences: 156 },
                    { frequency: 4417, amplitude: -19.876, occurrences: 142 },
                    { frequency: 2208, amplitude: -17.542, occurrences: 89 },
                    { frequency: 1104, amplitude: -16.234, occurrences: 67 },
                    { frequency: 552, amplitude: -18.765, occurrences: 45 },
                    { frequency: 276, amplitude: -22.123, occurrences: 34 },
                    { frequency: 138, amplitude: -25.456, occurrences: 23 },
                    { frequency: 69, amplitude: -28.789, occurrences: 12 },
                    { frequency: 35538, amplitude: -24.567, occurrences: 78 },
                    { frequency: 26653, amplitude: -26.234, occurrences: 56 },
                    { frequency: 13326, amplitude: -23.891, occurrences: 87 },
                    { frequency: 6663, amplitude: -20.345, occurrences: 123 },
                    { frequency: 3332, amplitude: -18.123, occurrences: 167 },
                    { frequency: 1666, amplitude: -16.789, occurrences: 189 }
                ]
            },
            
            performance: {
                totalTimeMs: 3000,
                backendPhase: '5.1-5.4-mathematical-complete',
                fftOperations: 10509,
                samplesProcessed: 43115140
            },
            
            metadata: {
                sampleRate: 48000,
                channels: 2,
                duration: 897.6,
                pipelineVersion: '5.1-5.4-mathematical-complete'
            },
            
            problems: [
                {
                    type: 'peak',
                    severity: 'critical',
                    description: 'True Peak muito alto - risco de clipping digital'
                }
            ],
            
            suggestions: [
                {
                    message: 'An√°lise completa de undefined finalizada com 15 frequ√™ncias mapeadas',
                    type: 'info'
                }
            ]
        };

        // Fun√ß√µes de teste
        function loadCorrections() {
            const script = document.createElement('script');
            script.src = 'audit-corrections-extension.js';
            script.onload = () => {
                updateStatus('success', '‚úÖ Corre√ß√µes carregadas com sucesso!');
                console.log('üéâ Extens√µes carregadas');
            };
            script.onerror = () => {
                updateStatus('warning', '‚ùå Falha ao carregar corre√ß√µes');
            };
            document.head.appendChild(script);
        }

        function updateStatus(type, message) {
            const status = document.getElementById('correctionStatus');
            status.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function testCorrections() {
            if (!window.AUDIT_CORRECTIONS_LOADED) {
                updateStatus('warning', '‚ö†Ô∏è Carregue as corre√ß√µes primeiro!');
                return;
            }

            updateStatus('success', 'üß™ Executando testes...');
            
            // Mostrar √°rea de testes
            const testResults = document.getElementById('testResults');
            testResults.style.display = 'grid';
            
            // Mostrar containers de simula√ß√£o
            document.getElementById('modalTechnicalData').style.display = 'block';
            
            // Executar testes das corre√ß√µes
            setTimeout(() => {
                // Teste 1: Bandas espectrais
                if (window.renderReferenceComparisonsEnhanced) {
                    window.renderReferenceComparisonsEnhanced(simulatedAnalysisData);
                    addTestResult('‚úÖ Teste Bandas Espectrais', 'Renderiza√ß√£o de 6 bandas funcionando');
                }
                
                // Teste 2: Metadata
                if (window.injectMetadataCard) {
                    window.injectMetadataCard(simulatedAnalysisData);
                    addTestResult('‚úÖ Teste Metadata', 'Card de metadata completa injetado');
                }
                
                // Teste 3: Frequ√™ncias
                if (window.injectFrequenciesCard) {
                    window.injectFrequenciesCard(simulatedAnalysisData);
                    addTestResult('‚úÖ Teste Frequ√™ncias', '15 frequ√™ncias dominantes processadas');
                }
                
                updateStatus('success', 'üéâ Todos os testes executados com sucesso!');
            }, 500);
        }

        function simulateAnalysis() {
            if (!window.AUDIT_CORRECTIONS_LOADED) {
                updateStatus('warning', '‚ö†Ô∏è Carregue as corre√ß√µes primeiro!');
                return;
            }

            updateStatus('success', 'üéµ Simulando an√°lise completa...');
            
            // Simular processo completo
            if (window.applyAuditCorrections) {
                window.applyAuditCorrections(simulatedAnalysisData);
                addTestResult('‚úÖ Simula√ß√£o Completa', 'Todas as corre√ß√µes aplicadas automaticamente');
            }
        }

        function addTestResult(title, description) {
            const testResults = document.getElementById('testResults');
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <div class="card-title">${title}</div>
                <div class="data-row">
                    <span class="label">Status</span>
                    <span class="value" style="color: #52f7ad;">PASSOU</span>
                </div>
                <div class="data-row">
                    <span class="label">Descri√ß√£o</span>
                    <span class="value">${description}</span>
                </div>
                <div class="data-row">
                    <span class="label">Timestamp</span>
                    <span class="value">${new Date().toLocaleTimeString()}</span>
                </div>
            `;
            testResults.appendChild(card);
        }

        // Auto-carregar corre√ß√µes quando p√°gina carregar
        window.addEventListener('load', () => {
            setTimeout(loadCorrections, 1000);
        });
    </script>
</body>
</html>
