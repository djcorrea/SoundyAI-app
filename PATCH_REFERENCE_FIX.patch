diff --git a/public/audio-analyzer-integration.js b/public/audio-analyzer-integration.js
index original..fixed 100644
--- a/public/audio-analyzer-integration.js
+++ b/public/audio-analyzer-integration.js
@@ -2642,32 +2642,47 @@ function buildReferencePayload(fileKey, fileName, idToken, options = {}) {
     console.log('[PR2] buildReferencePayload()', { isFirstTrack, referenceJobId });
     
     if (isFirstTrack) {
-        // PRIMEIRA TRACK: envia como genre para an√°lise base
-        console.log('[PR2] Reference primeira track - usando buildGenrePayload como base');
-        const basePayload = buildGenrePayload(fileKey, fileName, idToken);
+        // ‚úÖ CORRE√á√ÉO: PRIMEIRA TRACK em reference deve enviar mode='reference'
+        // Backend sabe que √© primeira track pela aus√™ncia de referenceJobId
+        console.log('[PR2] Reference primeira track - criando payload limpo de reference');
         
-        // Adicionar flag indicando que √© base de refer√™ncia
-        basePayload.isReferenceBase = true;
+        const payload = {
+            fileKey,
+            mode: 'reference',  // ‚úÖ FIX: mode correto para reference
+            fileName,
+            isReferenceBase: true,  // Flag para backend saber que √© primeira
+            referenceJobId: null,   // null = primeira track
+            idToken
+        };
         
-        console.log('[PR2] Reference primeira track payload:', {
-            mode: basePayload.mode,
-            isReferenceBase: basePayload.isReferenceBase,
-            hasGenre: !!basePayload.genre
+        console.log('[PR2] ‚úÖ Reference primeira track payload:', {
+            mode: payload.mode,
+            isReferenceBase: payload.isReferenceBase,
+            hasGenre: false,  // ‚úÖ NUNCA incluir genre em reference
+            hasTargets: false  // ‚úÖ NUNCA incluir genreTargets em reference
         });
         
-        return basePayload;
+        // üîí SANITY CHECK: Garantir que N√ÉO tem genre/genreTargets
+        if (payload.genre || payload.genreTargets) {
+            console.error('[PR2] SANITY_FAIL: Reference primeira track tem genre/targets!', payload);
+            throw new Error('[PR2] Reference primeira track N√ÉO deve ter genre/genreTargets');
+        }
+        
+        return payload;
     } else {
-        // SEGUNDA TRACK: payload limpo SEM genre/genreTargets
+        // ‚úÖ SEGUNDA TRACK: payload com referenceJobId para compara√ß√£o
         if (!referenceJobId) {
             throw new Error('[PR2] buildReferencePayload: segunda track requer referenceJobId');
         }
         
         const payload = {
             fileKey,
-            mode: 'reference',
+            mode: 'reference',  // ‚úÖ mode correto
             fileName,
-            referenceJobId,
+            referenceJobId,     // JobId da primeira m√∫sica
+            isReferenceBase: false,  // Segunda track = compara√ß√£o
             idToken
         };
         
@@ -7141,8 +7156,14 @@ function resetModalState() {
         return;
     }
     
-    // üîí PATCH: PRESERVAR G√äNERO ANTES DE QUALQUER OPERA√á√ÉO
-    preserveGenreState();
+    // ‚úÖ CORRE√á√ÉO: N√ÉO preservar g√™nero em modo reference
+    // Isso estava causando contamina√ß√£o de estado
+    if (currentMode !== 'reference') {
+        // üîí PATCH: PRESERVAR G√äNERO SOMENTE EM MODO GENRE
+        preserveGenreState();
+    } else {
+        console.log('[REF_FIX] üîí preserveGenreState() BLOQUEADO - modo Reference n√£o usa g√™nero');
+    }
     
     // ===============================================================
     // üîí BLOCO 1 ‚Äî PRESERVAR G√äNERO ANTES DO RESET
@@ -7150,22 +7171,30 @@ function resetModalState() {
     let __PRESERVED_GENRE__ = null;
     let __PRESERVED_TARGETS__ = null;
 
-    try {
-        const genreSelect = document.getElementById("audioRefGenreSelect");
-
-        __PRESERVED_GENRE__ =
-            window.__CURRENT_SELECTED_GENRE ||
-            window.PROD_AI_REF_GENRE ||
-            (genreSelect ? genreSelect.value : null);
-        
-        __PRESERVED_TARGETS__ =
-            window.__CURRENT_GENRE_TARGETS ||
-            window.currentGenreTargets ||
-            window.__activeRefData?.targets;
-
-        console.log("[SAFE-RESET] ‚ö†Ô∏è Preservando g√™nero selecionado:", __PRESERVED_GENRE__);
-        console.log("[SAFE-RESET] ‚ö†Ô∏è Preservando targets:", __PRESERVED_TARGETS__ ? Object.keys(__PRESERVED_TARGETS__) : 'null');
-    } catch (e) {
-        console.warn("[SAFE-RESET] Falha ao capturar g√™nero antes do reset:", e);
+    // ‚úÖ CORRE√á√ÉO: S√≥ preservar g√™nero se N√ÉO estiver em modo reference
+    if (currentMode !== 'reference') {
+        try {
+            const genreSelect = document.getElementById("audioRefGenreSelect");
+
+            __PRESERVED_GENRE__ =
+                window.__CURRENT_SELECTED_GENRE ||
+                window.PROD_AI_REF_GENRE ||
+                (genreSelect ? genreSelect.value : null);
+            
+            __PRESERVED_TARGETS__ =
+                window.__CURRENT_GENRE_TARGETS ||
+                window.currentGenreTargets ||
+                window.__activeRefData?.targets;
+
+            console.log("[SAFE-RESET] ‚ö†Ô∏è Preservando g√™nero selecionado:", __PRESERVED_GENRE__);
+            console.log("[SAFE-RESET] ‚ö†Ô∏è Preservando targets:", __PRESERVED_TARGETS__ ? Object.keys(__PRESERVED_TARGETS__) : 'null');
+        } catch (e) {
+            console.warn("[SAFE-RESET] Falha ao capturar g√™nero antes do reset:", e);
+        }
+    } else {
+        console.log("[REF_FIX] üîí Preserva√ß√£o de g√™nero/targets BLOQUEADA - modo Reference ativo");
     }
     
     // Mostrar √°rea de upload
@@ -7257,22 +7286,25 @@ function resetModalState() {
     // üîí BLOCO 3 ‚Äî RESTAURAR G√äNERO E TARGETS AP√ìS O RESET
     // ===============================================================
     try {
-        const genreSelect = document.getElementById("audioRefGenreSelect");
+        // ‚úÖ CORRE√á√ÉO: S√≥ restaurar g√™nero se N√ÉO estiver em modo reference
+        if (currentMode !== 'reference') {
+            const genreSelect = document.getElementById("audioRefGenreSelect");
 
-        if (__PRESERVED_GENRE__ && typeof __PRESERVED_GENRE__ === "string") {
-            window.__CURRENT_SELECTED_GENRE = __PRESERVED_GENRE__;
-            window.PROD_AI_REF_GENRE = __PRESERVED_GENRE__;
+            if (__PRESERVED_GENRE__ && typeof __PRESERVED_GENRE__ === "string") {
+                window.__CURRENT_SELECTED_GENRE = __PRESERVED_GENRE__;
+                window.PROD_AI_REF_GENRE = __PRESERVED_GENRE__;
 
-            if (genreSelect) {
-                genreSelect.value = __PRESERVED_GENRE__;
-            }
+                if (genreSelect) {
+                    genreSelect.value = __PRESERVED_GENRE__;
+                }
 
-            console.log("[SAFE-RESET] ‚úÖ G√™nero restaurado ap√≥s reset:", __PRESERVED_GENRE__);
+                console.log("[SAFE-RESET] ‚úÖ G√™nero restaurado ap√≥s reset:", __PRESERVED_GENRE__);
+            } else {
+                console.warn("[SAFE-RESET] ‚ö†Ô∏è Nenhum g√™nero v√°lido preservado.");
+            }
         } else {
-            console.warn("[SAFE-RESET] ‚ö†Ô∏è Nenhum g√™nero v√°lido preservado.");
+            console.log("[REF_FIX] üîí Restaura√ß√£o de g√™nero BLOQUEADA - modo Reference ativo");
         }
-        
-        // üîí PATCH: RESTAURAR TARGETS TAMB√âM
         if (__PRESERVED_TARGETS__) {
             window.__CURRENT_GENRE_TARGETS = __PRESERVED_TARGETS__;
             window.currentGenreTargets = __PRESERVED_TARGETS__;
